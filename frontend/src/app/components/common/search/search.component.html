<app-navbar></app-navbar>

<!-- Search results bar -->
<div class="sticky top-0 z-30 w-full border-b border-surface-200 bg-surface-50 backdrop-blur-sm shadow-sm">
  <div class="max-w-7xl mx-auto px-6 sm:px-8 py-4 flex items-center justify-between">
    <h1 class="text-2xl sm:text-3xl font-semibold tracking-tight text-surface-900">
      <span class="text-primary-500 font-extrabold">{{ foundProducts.totalProducts }}</span> resultados
      <ng-container *ngIf="searchQuery">
        para <span class="italic text-surface-600">"{{ searchQuery }}"</span>
      </ng-container>
    </h1>
  </div>
</div>


<main class="max-w-[88rem] mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-10">
  <div class="grid grid-cols-1 lg:grid-cols-4 gap-10">

    <!-- Filter sidebar -->
    <aside class="hidden lg:block col-span-1">
      <div class="bg-surface-0 p-6 rounded-2xl shadow-md border border-surface-200 hover:shadow-lg transition-all duration-300 sticky top-28">

        <!-- Filter: Categories -->
        <div class="pb-6 mb-6 border-b border-surface-200">
          <h3 class="flex justify-between items-center text-lg font-bold mb-4 text-surface-800">
            Categorías
            <svg class="w-5 h-5 text-surface-400 transform rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </h3>
          <ul class="space-y-3">
            <li>
              <label class="flex items-center gap-3 group cursor-pointer">
                <input type="checkbox" class="accent-primary-400 h-4 w-4 rounded border-surface-300 focus:ring-primary-400">
                <span class="text-sm text-surface-700 group-hover:text-primary-500 transition-colors">Apple</span>
              </label>
            </li>
            <li>
              <label class="flex items-center gap-3 group cursor-pointer">
                <input type="checkbox" class="accent-primary-400 h-4 w-4 rounded border-surface-300 focus:ring-primary-400">
                <span class="text-sm text-surface-700 group-hover:text-primary-500 transition-colors">Telefonía</span>
              </label>
            </li>
            <li>
              <label class="flex items-center gap-3 group cursor-pointer">
                <input type="checkbox" class="accent-primary-400 h-4 w-4 rounded border-surface-300 focus:ring-primary-400">
                <span class="text-sm text-surface-700 group-hover:text-primary-500 transition-colors">Móviles</span>
              </label>
            </li>
          </ul>
        </div>

        <!-- Filter: Brand -->
        <div class="pb-6 mb-6 border-b border-surface-200">
          <h3 class="flex justify-between items-center text-lg font-bold mb-4 text-surface-800">
            Marca
            <svg class="w-5 h-5 text-surface-400 transform rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </h3>
          <ul class="space-y-3">
            <li><label class="flex items-center gap-3 group cursor-pointer"><input type="checkbox" checked class="accent-primary-400 h-4 w-4 rounded border-surface-300 focus:ring-primary-400"> <span class="text-sm text-surface-700 group-hover:text-primary-500 transition-colors">Apple</span></label></li>
            <li><label class="flex items-center gap-3 group cursor-pointer"><input type="checkbox" class="accent-primary-400 h-4 w-4 rounded border-surface-300 focus:ring-primary-400"> <span class="text-sm text-surface-700 group-hover:text-primary-500 transition-colors">Samsung</span></label></li>
            <li><label class="flex items-center gap-3 group cursor-pointer"><input type="checkbox" class="accent-primary-400 h-4 w-4 rounded border-surface-300 focus:ring-primary-400"> <span class="text-sm text-surface-700 group-hover:text-primary-500 transition-colors">Xiaomi</span></label></li>
          </ul>
          <a routerLink="#" class="text-primary-500 font-semibold text-sm mt-4 inline-block hover:underline">Ver más</a>
        </div>

        <!-- Filter: Price -->
        <div>
          <h3 class="flex justify-between items-center text-lg font-bold mb-4 text-surface-800">
            Precio
            <svg class="w-5 h-5 text-surface-400 transform rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </h3>
          <ul class="space-y-3">
            <li><label class="flex items-center gap-3 group cursor-pointer"><input type="checkbox" class="accent-primary-400 h-4 w-4 rounded border-surface-300 focus:ring-primary-400"> <span class="text-sm text-surface-700 group-hover:text-primary-500 transition-colors">500€ - 1000€</span></label></li>
            <li><label class="flex items-center gap-3 group cursor-pointer"><input type="checkbox" class="accent-primary-400 h-4 w-4 rounded border-surface-300 focus:ring-primary-400"> <span class="text-sm text-surface-700 group-hover:text-primary-500 transition-colors">1000€ - 1500€</span></label></li>
          </ul>
        </div>
      </div>
    </aside>

    <!-- Products -->
    <section class="col-span-1 lg:col-span-3 flex flex-col gap-6">

      <!-- Sorting bar -->
      <div class="flex flex-wrap justify-between items-center bg-surface-0 border border-surface-200 rounded-2xl p-4 sm:p-5 shadow-sm hover:shadow-md transition-all duration-300">
        <button class="lg:hidden flex items-center gap-2 px-4 py-2 rounded-xl border border-surface-300 text-sm font-semibold text-surface-700 bg-surface-50 hover:bg-surface-100 transition-colors">
          <svg class="w-4 h-4 text-surface-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"/>
          </svg>
          Filtrar
        </button>

        <div class="flex items-center gap-2 ml-auto">
          <label for="sort-by" class="text-sm font-medium text-surface-700 hidden sm:block">Ordenar por:</label>
          <p-select
            [options]="sortOptions"
            [(ngModel)]="selectedSortOption"
            (onChange)="onSortChange()"
            optionLabel="name"
            styleClass="p-inputtext-sm"
            class="w-44 sm:w-52"
          ></p-select>
        </div>
      </div>

      <!-- Products grid -->
      <ng-container *ngIf="!loading && !error && foundProducts.products.length; else noProducts">
        <div class="grid xs:grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8">
          <ng-template ngFor let-product [ngForOf]="foundProducts.products">
            <app-product-card [product]="product"></app-product-card>
          </ng-template>
        </div>
      </ng-container>
      <ng-template #noProducts>
        <app-loading [loading]="loading" [error]="error" [numElements]="foundProducts.products.length" elementsType="productos que coincidan con la búsqueda"></app-loading>
      </ng-template>

      <!-- Pagination menu -->
      <div class="card flex justify-center items-center mt-2 sm:mt-8 p-4 bg-surface-0 border border-surface-200 rounded-2xl shadow-sm hover:shadow-md transition-all duration-300">
        <p-paginator
          (onPageChange)="onPageChange($event)"
          [first]="first"
          [rows]="rows"
          [totalRecords]="foundProducts.totalProducts"
          [rowsPerPageOptions]="[10, 20, 30]"
        ></p-paginator>
      </div>
    </section>
  </div>
</main>

<app-footer></app-footer>
